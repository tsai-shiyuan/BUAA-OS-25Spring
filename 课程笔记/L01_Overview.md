# 操作系统概述

## 操作系统简史

早期 $\rightarrow$ 批处理 $\rightarrow$ 分时 $\rightarrow$ 现代OS $\rightarrow$ 网络化OS/分布式OS

在早期，ENIAC上的软件采用汇编实现，由手工修改逻辑单元的连接

### 批处理 (batch processing)

批处理: 把用户提交的作业成批送入计算机，由作业调度程序自动选择作业运行，同时刻只有**一个**Job

目的: 缩短作业之间的交接时间，减少处理机的空闲等待

**联机批处理:** 作业的输入/输出由CPU来处理

- 原理:

  - 在主机与输入机之间增加一个存储设备，即磁带

  - 成批地把输入机上的用户作业读入磁带，依次把磁带上的用户作业读入主机内存并执行
  - 把计算结果向输出机输出

  - 完成后，监督程序又从输入机上输入另一批作业，重复上述步骤

- 不足: 在作业输入和结果输出时，主机的高速CPU仍处于空闲状态

**脱机批处理:** 输入/输出脱离主机控制

- 原理: 

  - 增加专门与输入/输出设备打交道的卫星机

  - 从输入机上读取用户作业并放到输入磁带上

  - 从输出磁带上读取执行结果并传给输出机

    ![截屏2025-04-15 13.39.00](./images_buaa/%E6%88%AA%E5%B1%8F2025-04-15%2013.39.00.png)

### 多道程序设计技术 (multi-programming)

功能: **多个**程序同时进入内存并运行。当一道程序因I/O请求而暂停运行时，CPU便立即转去运行另一道程序

缺点: 用户不能与提交的作业进行交互

### 分时系统 (multi-tasking)

**多个用户**分享使用同一台计算机，**多个程序**分时共享软硬件资源

机制: 将CPU处理时间分割为多个时间片，将时间片分给不同程序，达到多个程序“同时”运行的效果

### 网络化OS/分布式OS

- 网络操作系统: 在传统单机OS上加单独软件层，主要提供联网功能和资源的远程访问
- 分布式操作系统: 多台机器统一管理形成单一系统

## 计算机硬件

![截屏2025-04-15 14.01.46](./images_buaa/%E6%88%AA%E5%B1%8F2025-04-15%2014.01.46.png)

CPU的两种执行状态: 内核态 (kernel mode) 和用户态 (user mode)

trap指令可以实现用户态 $\rightarrow$ 内核态

## OS实现机制

### 异常 (Exceptions)

Exceptions: 陷阱 (trap) & 中断 (interrupts)

- 中断主要由I/O设备、处理器时钟或定时器等硬件产生，可以被启用或禁用
- 陷阱是用户进程中某一特定指令执行的结果，是程序内部有意设定的。例如: 系统调用

<img src="./images_buaa/%E6%88%AA%E5%B1%8F2025-03-10%2008.56.55.png" alt="截屏2025-03-10 08.56.55" style="zoom:50%;" />

## 操作系统的功能

**操作系统的主要作用**:

- 处理机管理
- 存储器管理
- 设备管理
- 文件管理: 将磁盘变成一个很容易使用的存储媒介提供给用户使用
- 作业控制

**操作系统的典型特征** (与其他软件相比) :

- **并发性**: 能够同时运行多个程序
- **共享性**: 多个用户/程序共享系统资源
- **虚拟性**: 将物理资源抽象为逻辑资源
- **异步性**: 程序执行的结果与时间有关
- **持久性**: 操作系统常驻内存
- **特权性**: 拥有对硬件的直接控制权

## 操作系统的结构

### Unix System Structure

![截屏2025-03-04 10.05.53](./images_buaa/%E6%88%AA%E5%B1%8F2025-03-04%2010.05.53.png)

### OS and Compiler

- 操作系统代码需要通过编译器成为机器码
- 编译器需要运行在操作系统上

$\Rightarrow$ 用汇编写编译器，再用子集递归完成C语言编译器

Makefile:

- 自动推倒出可执行文件
- Makefile中的target会根据dependencies是否变化来判断是否重新make	